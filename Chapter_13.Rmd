

# Inference for Comparing One Population Mean to a Threshold

```{r}
library(IntroStats)
```

## Hypothesis Test for One Population Mean when Population Standard Deviation Known (one-sample z-test or one-mean z-test)

### Motivating Example

One common estimate of cheetah's top speed is 60 mph. Table below shows
the top speeds of 35 cheetahs.

![Cheetah Top Speeds](https://i.ibb.co/18n1tzQ/392-Table-09-11.png)

At the 5\% significance level, do the data provide sufficient evidence
that cheetahs' top speeds differ from 60 mph? Assume the population
deviation ($\sigma$) is 3.2 mph.


### Test Statistic

The test statistic with population variance $\sigma^2$ known is 

$$z = \frac{\bar{x}-\mu}{\sigma/\sqrt{n}} \sim N(0, 1)$$

This test is called **one-sample z-test or one-mean z-test**, because the test statistic follows the standard normal distribution.
	

### The hypothesis Testing Procedure

![Procedure One-Mean z-Test](https://i.ibb.co/HppVVMX/Procedure9-1a.png)

![Procedure One-Mean z-Test](https://i.ibb.co/GnJ0ZBH/Procedure9-1b.png)

### Example: Cheetah Top Speeds

**Solution**:

We follow the steps to perform the z-test for the cheetah top speed problem.

1.  State the null and alternative hypotheses explicitly.
    $H_0: \mu = 60$ and $H_a: \mu \ne 60$.
2.  Determine the test statistic and its distribution. The test
    statistic is $z$ above.
3.  Determine the significance level. $\alpha = 0.05$.
4.  Determine the rejection region and critical values. For
    $\alpha=0.05$, the critical values are $\pm z_{1-0.05/2}=\pm 1.96$.
    The rejection region is $z \ge 1.96$ or $z \le -1.96$.
5.  Calculate the test statistic under $H_0$. We usually use lower case
    $z$ to denote the observed value of the random variable $Z$.
    $$z_0 = \frac{\bar{x}-\mu_0}{\sigma/\sqrt{n}} = \frac{59.526-60}{3.2/\sqrt{35}}=-0.877$$.
6.  Calculate the p value. The $P-$value is
    $2P(z > |-0.877|)=0.3806 > 0.05$.
7.  Make a statistical decision based on the p value or the calculated
    test statistic. Since $z = -0.877$ does not fall in the rejection
    region, $H_0$ is not rejected. Equivalently, $p > 0.05$, so $H_0$ is
    not rejected.
8.  Conclusion: At the 5\% significance level, the data do not provide
    sufficient evidence that cheetahs' top speeds differ from 60 mph.

This test is implemented in R as below. The corresponding
$(1-\alpha)100\%$ CI for $\mu$ is also produced.

```{r}
x <- c( 57.3, 57.5, 59.0, 56.5, 61.3,
        57.6, 59.2, 65.0, 60.1, 59.7,
         62.6, 52.6, 60.7, 62.3, 65.2,
        54.8, 55.4, 55.5, 57.8, 58.7,
        57.8, 60.9, 75.3, 60.6, 58.1,
       55.9, 61.6, 59.6, 59.8, 63.4,
        54.7, 60.2, 52.4, 58.3, 66.0)
one.mean.z(x=x, mu0=60, sigma=3.2, tail="two", alpha=0.05)

```

### Testing $H_0$ by confidence interval

The hypothesized value 60 mph is within the 95\% CI, so it is also
equivalent to conclude there is no sufficient evidence to conclude the
cheetahs' top speeds differ from 60 mph at significance level of 5\%. The
CI is (58.46557, 60.58586) which includes 60. So do not reject H0.

So CI method is equivalent to the p-value method and critical value
method.

### Checking for Outliers

Do we miss something here? Yes, check normality and outliers! One
outlier is identified.

![Cheetah Top Speeds](https://i.ibb.co/ysYBbtb/393-Figure-09-16a.png)
![Cheetah Top Speeds](https://i.ibb.co/ncTVB8W/393-Figure-09-16b.png)
![Cheetah Top Speeds](https://i.ibb.co/k8d2PtH/393-Figure-09-16c.png)
![Cheetah Top Speeds](https://i.ibb.co/n1QxTTH/393-Figure-09-16d.png)

### Pragmatic Approach

1.  Perform the z-test using **all** data;
2.  Perform the z-test **excluding the outlier**.

**Solution with Outlier Removal**

-   With all data included, $H_0$ is not rejected because
    $P=0.3788>0.05$ and $z = -0.88>-1.96$.
-   After excluding the outlier, $z=-1.71>-1.96$ and
    $P=2\cdot 0.0436=0.0872>0.05$. So $H_0$ is not rejected.

### Interpretation:

At the 5\% significance level, the data do not provide sufficient
evidence to conclude that the cheetahs' mean top speed differs from 60
mph. After removing the outlier, the conclusion still holds.

### Statistical Significance vs Practical Significance

Rejection of $H_0$ at significance level $\alpha$ establishes
**statistical significance**, i.e., the sampled data provide sufficient
evidence to conclude the truth is different from $H_0$. However, this
doesn't necessarily mean the difference is **practically important**.

-   With a larger sample size, it is easier to reject $H_0$ for the same
    hypothesis test. This is related to the **power** concept.
-   A statistical test could detect a **negligible difference** in
    practice when the sample size is large enough, but practically such
    a difference is not meaningful.
-   When interpreting data, always assess the statistical significance
    by hypothesis testing and assess whether the finding is practically
    meaningful.

### Example: Mean Blood Glucose Level

A lab claims that the average fasting blood glucose level for adults is
95 mg/dL. To assess this claim, a researcher collects a random sample of
36 adults and finds a sample mean of 
$$
\bar{x} = 98.4 \text{ mg/dL}.
$$ 
Assume the population standard deviation is 

$$
\sigma = 12 \text{ mg/dL}.
$$ 

Test, at the 5\% significance level, whether the mean fasting blood
glucose level is significantly different from 95 mg/dL.

**Step 1: Hypotheses** 

$$
H_0: \mu = 95
$$

$$
H_a: \mu \neq 95
$$

**Step 2: Test Statistic**

$$
z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} = \frac{98.4 - 95}{12 / \sqrt{36}} = \frac{3.4}{2} = 1.70
$$

**Step 3: Critical Value**

For the significance level $\alpha = 0.05$, the critical values are $\quad z_{0.975} = \pm 1.96$.

**Step 4: Decision**

$$
z = 1.70 < 1.96 \quad \Rightarrow \quad \text{Fail to reject } H_0
$$

**Conclusion:**

At the 5\% significance level, there is insufficient evidence to conclude
that the mean fasting blood glucose level differs from 95 mg/dL.

## Hypothesis Tests for One Population Mean When $\sigma$ Is Unknown (One-Mean t-test or One-Sample t-Test)

### Test statistic 

In the previous section, it was assumed that the standard deviation
$\sigma$ is known, then

$$
z = \frac{\bar{x}-\mu}{\sigma/\sqrt{n}}\sim N(0,1)
$$

However, it is usually unknown.

$$
t = \frac{\bar{x}-\mu}{s/\sqrt{n}}\sim t_{n-1}, 
$$ 

where $s$ is the sample standard deviation.

The one-mean t-test is constructed similarly to the z-test, with the critical value and $P$-value determined according to the t-distribution. The testing procedure is the same.

### Procedure: One-Mean t-Test

![One-Mean t-Test](https://i.ibb.co/nMff9gW/Procedure9-2a.png)

![One-Mean t-Test](https://i.ibb.co/72Fb2CQ/Procedure9-2b.png)

### Example: One-Mean t-Test

Table below shows the pH levels for 15 high mountain lakes in Southern
Alps. A lake is considered non-acidic if its pH is greater than 6.

![One-Mean t-Test](https://i.ibb.co/pZ5P5WV/401-Table-09-12.png)
![One-Mean t-Test](https://i.ibb.co/BPJryCb/402-Figure-09-21.png)

### Hypothesis Test

At the 5\% significance level, do the data provide sufficient evidence to
conclude that on average the high mountain lakes in Southern Alps are
non-acidic?

**Steps for One-Mean t-Test**:

1.  **State the Hypotheses**: $H_0: \mu = 6$ and $H_a: \mu > 6$
    (non-acidic).
2.  **Significance Level**: $\alpha = 0.05$.
3.  **Compute Test Statistic**:
    $t = \frac{\bar{x}-\mu_0}{s/\sqrt{n}}=\frac{6.6-6}{3.2/\sqrt{15}}=3.46$,
    where $\bar{x} = 6.6$ and $s=0.672$.
4.  **Critical Value Approach**: For $\alpha=0.05$, the critical value
    for a right-tailed $t$ test with df = 14 is $t_{0.05}=1.761$. Since
    $t=3.46$ is in the rejection region, we reject $H_0$.
5.  $P$-Value Approach: The test statistic $t=3.46$, and the $P$-value
    is $P=P(t_{14}>3.46)=0.0019<0.05$. Reject $H_0$.

![One-Mean t-Test](https://i.ibb.co/fxDDjW2/403-Figure-09-22a.png)

![One-Mean t-Test](https://i.ibb.co/n8Qw88J/403-Figure-09-22b.png)

```{r}
x = c(7.2, 7.3, 6.1, 6.9, 6.6,
      7.3, 6.3, 5.5, 6.3, 6.5,
      5.7, 6.9, 6.7, 7.9, 5.8)

one.mean.t(x=x, mu0=6, tail="right")
```

### Example: Mean HbA1c Level in Diabetic Patients

The following dataset contains glycated hemoglobin (HbA1c) levels (in \%)
for a sample of 12 diabetic patients. Clinical guidelines recommend that
well-controlled diabetes should have HbA1c \< 7\%.

We want to test whether the mean HbA1c level in this sample exceeds 7\%,
suggesting poor glycemic control. At the 5\% significance level, do the data provide sufficient evidence to conclude that the mean HbA1c level in this diabetic population is
greater than 7\%?

**Solution:**

-   State the Hypotheses: $H_0: \mu = 7$ $H_a: \mu > 7$

-   Significance Level: $\alpha = 0.05$

-   Compute Test Statistic:

Sample mean: $\bar{x} = 7.55$. Sample standard deviation: $s = 0.47$. Sample size: $n = 12$. The test statistic is

$$
t = \frac{\bar{x} - \mu_0}{s / \sqrt{n}} = \frac{7.55 - 7}{\frac{0.47}{\sqrt{12}}} = 4.04
$$
-   Critical Value Approach:

Degrees of freedom: $df = 12 - 1 = 11$. Critical value: $t_{0.05,11} = 1.796$. Since $t = 4.04 > 1.796$, we reject $H_0$.

-   P-Value Approach:

$P = P(t_{11} > 4.04) = 0.0012 < 0.05$. Again, we reject $H_0$.

The procedure is implemented below:

```{r}
hba1c = c(7.2, 7.4, 6.9, 8.1, 7.7, 7.5, 
          8.3, 7.9, 6.8, 7.6, 7.0, 8.0)
one.mean.t(x=hba1c, mu0=7, tail="right")
```

Using R built-in function, 

```{r}
t.test(hba1c, mu = 7, alternative = "greater")
```


